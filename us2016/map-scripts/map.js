"use strict";function updateMap(a){function b(a,b){if(a.clinton==a.trump)return"Neutral";var c=a.clinton>a.trump?"Democrat":"Republican",d="";return a.total<b.upper_light?d="Light ":a.total>=b.upper_medium&&(d="Heavy "),d+c}function c(){function b(a,b){var c='<div class="hoverinfo">'+a.properties.name+"<br/>";const d='<span style="white-space: nowrap">';return c+=d+"Total Tweets: "+b.total+"</span><br>",c+=d+"Tweets pro Trump: "+b.trump_precentage+"%</span><br/>",c+=d+"Tweets pro Clinton: "+b.clinton_precentage+"%</span><br/>",c+=d+"Electoral Votes: "+b.electoralVotes+"</span><br/>",c+="</div>"}const c={dom:"chart_1",width:800,height:400,scope:"usa",fills:d,data:a,geographyConfig:{highlightBorderColor:"#bada55",popupTemplate:b},legend:!0,labels:!0};c.element=document.getElementById("container"),map=new Datamap(c),map.labels(),c.legend&&map.legend()}const d={"Heavy Republican":"#ff0000","Heavy Democrat":"#0000ff",Democrat:"#4d4dff","Light Democrat":"#9999ff",Republican:"#ff4d4d","Light Republican":"#ff9999",Neutral:"gray",defaultFill:"#EDDC4E"};void 0==map&&c();var e=Object.keys(a).reduce(function(b,c){const d=a[c];return d.total=d.clinton+d.trump+d.neutral,d.trump_precentage=(100*d.trump/d.total).toFixed(2),d.clinton_precentage=(100*d.clinton/d.total).toFixed(2),b+d.total},0);const f={upper_light:parseInt(e/3/51),upper_medium:parseInt(2*e/3/51)};Object.keys(a).forEach(function(c){const d=a[c];d.fillKey=b(d,f)}),map.updateChoropleth(a,{reset:!0})}angular.module("c2App",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/map.html"}).otherwise({redirectTo:"/"})}]),angular.module("c2App").factory("dataService",["$http",function(a){const b={};return b.inputs=function(){const a=moment.tz(moment(),"America/Phoenix");for(var b=moment("2016-10-03"),c=[];a>=b;)c.push(b.format("YYYY-MM-DD")),b=moment(b).add(1,"days");return c},b.fetchInput=function(b,c){const d="https://mc-agg.s3-eu-west-1.amazonaws.com/",e="agg3-",f=d+e+b+".json";a.get(f).success(function(a){c(a)})},b}]);var map;angular.module("c2App").controller("MapCtrl",["$scope","dataService",function(a,b){a.inputs=b.inputs(),a.max=a.inputs.length-1,a.inputIndex=a.max,a.$watch("inputIndex",function(c){a.input=a.inputs[c],b.fetchInput(a.input,function(a){updateMap(a)})})}]),angular.module("c2App").run(["$templateCache",function(a){a.put("views/map.html",'<div ng-controller="MapCtrl"> <table> <tr> <td><span>Date</span></td> <td> <input id="slider" type="range" min="0" max="{{max}}" ng-model="inputIndex" value="0" width="200"> <span ng-bind="input"></span> </td> </tr> </table> <div id="container" style="position: relative; width: 500px; height: 500px"></div> </div>')}]);